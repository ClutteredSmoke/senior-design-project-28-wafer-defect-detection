# senior-design-project-28-wafer-defect-detection
This project aims to process a 2D image into a Convolutional Neural Network in order to find all wafer defects and their corresponding locations.

As of right now, preprocess_images.py will convert 2D images into a grayscale format and displays an image of each magnification, which I will show below. It then displays the number of images scanned as well as an array representation of each grayscale image to the console, also shown below. It also stores all of the data into a pickle file (not included in repository) for later use without the need of pre-processing every time.

Previous image
![10X_BOTEDGE](https://media.github.ncsu.edu/user/19974/files/0dc9f3ba-9082-48b1-b310-fb2f86835af8)

Processed image
![image](https://media.github.ncsu.edu/user/19974/files/cb16a86e-6a2f-4552-988e-898e6b9b13a7)

Console output
Number of Training Images:  63
Training Data:  [array([[124, 123, 121, ..., 163, 161, 160],
       [123, 123, 120, ..., 165, 164, 164],
       [122, 122, 121, ..., 166, 165, 166],
       ...,
       [ 69,  68,  68, ...,  84,  85,  85],
       [ 68,  67,  66, ...,  85,  85,  85],
       [ 68,  67,  66, ...,  84,  84,  84]], dtype=uint8), array([[212, 212, 213, ..., 242, 238, 237],
       [212, 213, 214, ..., 245, 243, 243],
       [213, 214, 215, ..., 246, 245, 247],
       ...,
       [111, 112, 113, ..., 131, 130, 130],
       [111, 112, 112, ..., 131, 131, 131],
       [112, 111, 112, ..., 130, 130, 131]], dtype=uint8), array([[191, 189, 187, ..., 209, 206, 202],
       [189, 188, 188, ..., 211, 210, 209],
       [188, 189, 190, ..., 212, 212, 213],
       ...,
       [104, 103, 103, ..., 118, 118, 119],
       [104, 103, 103, ..., 118, 118, 119],
       [104, 103, 102, ..., 118, 118, 119]], dtype=uint8), array([[189, 188, 187, ..., 197, 193, 191],
       [190, 190, 189, ..., 199, 196, 196],
       [190, 190, 190, ..., 199, 198, 200],
       ...,
       [ 94,  94,  94, ..., 118, 117, 117],
       [ 94,  94,  94, ..., 118, 117, 117],
       [ 93,  93,  93, ..., 118, 118, 118]], dtype=uint8), array([[194, 193, 192, ..., 211, 208, 206],
       [193, 192, 192, ..., 213, 212, 212],
       [193, 193, 193, ..., 213, 213, 214],
       ...,
       [104, 103, 103, ..., 121, 122, 122],
       [103, 103, 103, ..., 121, 121, 121],
       [103, 103, 103, ..., 121, 121, 121]], dtype=uint8), array([[198, 199, 201, ..., 194, 189, 185],
       [200, 201, 201, ..., 196, 194, 191],
       [201, 201, 201, ..., 195, 195, 195],
       ...,
       [113, 112, 113, ..., 125, 123, 122],
       [114, 112, 113, ..., 125, 124, 123],
       [114, 112, 113, ..., 125, 124, 124]], dtype=uint8), array([[191, 193, 194, ..., 184, 180, 179],
       [192, 193, 194, ..., 186, 184, 185],
       [191, 192, 193, ..., 185, 186, 187],
       ...,
       [109, 109, 108, ..., 121, 120, 121],
       [108, 108, 107, ..., 121, 121, 121],
       [108, 108, 107, ..., 120, 120, 120]], dtype=uint8), array([[191, 190, 190, ..., 180, 177, 177],
       [190, 190, 190, ..., 182, 182, 184],
       [189, 190, 190, ..., 182, 182, 183],
       ...,
       [107, 108, 108, ..., 117, 117, 117],
       [107, 108, 107, ..., 117, 116, 116],
       [106, 106, 106, ..., 118, 117, 117]], dtype=uint8), array([[191, 191, 189, ..., 197, 193, 190],
       [190, 190, 189, ..., 199, 198, 198],
       [188, 189, 189, ..., 200, 201, 202],
       ...,
       [ 93,  92,  93, ..., 120, 120, 119],
       [ 93,  92,  92, ..., 119, 119, 119],
       [ 93,  93,  93, ..., 118, 118, 119]], dtype=uint8), array([[213, 213, 212, ..., 229, 225, 221],
       [212, 212, 212, ..., 234, 232, 230],
       [211, 212, 212, ..., 235, 235, 234],
       ...,
       [115, 116, 116, ..., 134, 135, 136],
       [114, 115, 115, ..., 133, 135, 135],
       [114, 114, 114, ..., 133, 134, 134]], dtype=uint8), array([[197, 197, 197, ..., 202, 197, 193],
       [197, 197, 197, ..., 206, 203, 201],
       [196, 196, 196, ..., 205, 205, 203],
       ...,
       [ 97,  97,  96, ..., 122, 121, 121],
       [ 97,  97,  96, ..., 122, 122, 121],
       [ 97,  96,  96, ..., 122, 121, 121]], dtype=uint8), array([[152, 153, 154, ..., 185, 180, 177],
       [152, 153, 154, ..., 188, 186, 186],
       [153, 153, 154, ..., 188, 189, 191],
       ...,
       [ 91,  91,  90, ..., 107, 107, 107],
       [ 90,  89,  90, ..., 107, 107, 107],
       [ 90,  90,  90, ..., 107, 107, 107]], dtype=uint8), array([[200, 201, 201, ..., 205, 201, 196],
       [200, 201, 201, ..., 209, 207, 204],
       [200, 200, 200, ..., 209, 208, 207],
       ...,
       [ 99,  99,  99, ..., 121, 120, 120],
       [ 98,  98,  98, ..., 120, 121, 121],
       [ 98,  97,  97, ..., 120, 121, 122]], dtype=uint8), array([[206, 205, 205, ..., 206, 202, 199],
       [204, 204, 204, ..., 210, 208, 207],
       [203, 204, 205, ..., 210, 210, 209],
       ...,
       [100, 100, 100, ..., 124, 124, 124],
       [100, 100,  99, ..., 123, 124, 124],
       [100, 100,  99, ..., 123, 124, 125]], dtype=uint8), array([[205, 207, 208, ..., 233, 226, 223],
       [206, 207, 208, ..., 237, 234, 233],
       [206, 206, 207, ..., 238, 236, 237],
       ...,
       [113, 112, 111, ..., 132, 130, 130],
       [113, 112, 111, ..., 131, 130, 130],
       [113, 112, 111, ..., 130, 130, 130]], dtype=uint8), array([[199, 198, 197, ...,  27,  26,  27],
       [198, 197, 197, ...,  27,  27,  27],
       [198, 197, 197, ...,  27,  27,  27],
       ...,
       [112, 113, 112, ...,  27,  27,  27],
       [112, 112, 111, ...,  27,  27,  27],
       [112, 112, 110, ...,  27,  27,  27]], dtype=uint8), array([[201, 201, 199, ..., 205, 200, 199],
       [199, 201, 202, ..., 208, 206, 206],
       [198, 201, 203, ..., 208, 208, 210],
       ...,
       [ 99,  99,  99, ..., 122, 123, 123],
       [ 99,  99,  98, ..., 122, 123, 122],
       [ 99,  98,  97, ..., 122, 122, 121]], dtype=uint8), array([[186, 185, 185, ..., 207, 203, 202],
       [185, 185, 185, ..., 210, 208, 208],
       [184, 184, 184, ..., 210, 210, 209],
       ...,
       [102, 101, 101, ..., 116, 116, 117],
       [102, 101, 101, ..., 116, 116, 116],
       [102, 101, 100, ..., 116, 116, 116]], dtype=uint8), array([[199, 199, 199, ..., 179, 176, 174],
       [199, 199, 199, ..., 182, 181, 181],
       [199, 199, 199, ..., 182, 182, 184],
       ...,
       [118, 117, 117, ..., 125, 126, 126],
       [118, 117, 116, ..., 124, 126, 125],
       [117, 116, 115, ..., 124, 125, 125]], dtype=uint8), array([[192, 192, 192, ..., 182, 178, 175],
       [192, 192, 192, ..., 182, 180, 178],
       [192, 191, 191, ..., 183, 182, 181],
       ...,
       [108, 108, 108, ..., 120, 120, 121],
       [108, 108, 107, ..., 119, 120, 121],
       [108, 107, 105, ..., 118, 119, 120]], dtype=uint8), array([[160, 158, 157, ..., 186, 182, 181],
       [158, 157, 156, ..., 189, 187, 187],
       [157, 156, 156, ..., 189, 189, 189],
       ...,
       [ 95,  95,  94, ..., 111, 111, 112],
       [ 95,  94,  94, ..., 110, 110, 111],
       [ 95,  94,  94, ..., 110, 109, 109]], dtype=uint8), array([[208, 207, 207, ..., 206, 203, 202],
       [207, 207, 208, ..., 210, 209, 209],
       [206, 207, 208, ..., 211, 211, 211],
       ...,
       [104, 103, 101, ..., 125, 125, 126],
       [103, 102, 102, ..., 125, 125, 126],
       [102, 102, 102, ..., 125, 125, 127]], dtype=uint8), array([[184, 183, 183, ..., 179, 176, 173],
       [184, 183, 183, ..., 182, 181, 179],
       [184, 183, 183, ..., 182, 181, 180],
       ...,
       [100, 100,  99, ..., 110, 110, 111],
       [ 99,  99,  99, ..., 110, 110, 111],
       [ 99,  99,  99, ..., 110, 110, 111]], dtype=uint8), array([[194, 194, 194, ..., 211, 206, 203],
       [193, 193, 193, ..., 213, 212, 212],
       [192, 192, 192, ..., 213, 213, 214],
       ...,
       [106, 105, 104, ..., 122, 121, 122],
       [105, 105, 105, ..., 122, 122, 123],
       [104, 105, 105, ..., 121, 121, 122]], dtype=uint8), array([[118, 117, 117, ..., 161, 157, 154],
       [118, 118, 118, ..., 162, 160, 159],
       [118, 118, 118, ..., 162, 162, 162],
       ...,
       [ 67,  66,  66, ...,  82,  82,  83],
       [ 66,  66,  65, ...,  82,  82,  82],
       [ 66,  65,  64, ...,  81,  81,  81]], dtype=uint8), array([[208, 207, 206, ..., 197, 194, 190],
       [206, 206, 206, ..., 200, 198, 197],
       [204, 206, 206, ..., 199, 198, 200],
       ...,
       [115, 115, 115, ..., 125, 126, 126],
       [116, 115, 114, ..., 125, 125, 125],
       [116, 115, 113, ..., 124, 125, 125]], dtype=uint8), array([[193, 193, 191, ..., 211, 206, 202],
       [191, 191, 191, ..., 214, 213, 212],
       [191, 191, 192, ..., 214, 214, 215],
       ...,
       [104, 104, 104, ..., 122, 122, 123],
       [104, 104, 104, ..., 121, 121, 122],
       [104, 104, 103, ..., 121, 121, 122]], dtype=uint8), array([[193, 193, 193, ..., 186, 181, 179],
       [193, 193, 194, ..., 189, 188, 188],
       [192, 193, 194, ..., 190, 188, 188],
       ...,
       [108, 108, 108, ..., 120, 120, 121],
       [108, 108, 108, ..., 120, 120, 121],
       [110, 108, 108, ..., 120, 120, 120]], dtype=uint8), array([[190, 191, 191, ..., 180, 176, 173],
       [189, 190, 191, ..., 183, 180, 178],
       [188, 190, 191, ..., 183, 182, 181],
       ...,
       [109, 109, 108, ..., 120, 120, 121],
       [108, 107, 107, ..., 119, 120, 121],
       [107, 107, 106, ..., 119, 119, 120]], dtype=uint8), array([[199, 199, 199, ..., 191, 187, 184],
       [199, 200, 200, ..., 194, 192, 190],
       [199, 200, 201, ..., 195, 194, 194],
       ...,
       [112, 112, 111, ..., 125, 125, 123],
       [113, 113, 112, ..., 123, 124, 123],
       [113, 112, 111, ..., 122, 123, 123]], dtype=uint8), array([[201, 202, 201, ..., 206, 201, 199],
       [201, 202, 201, ..., 208, 206, 205],
       [200, 200, 200, ..., 208, 207, 207],
       ...,
       [ 98,  97,  97, ..., 121, 121, 121],
       [ 99,  98,  97, ..., 121, 121, 121],
       [ 98,  97,  96, ..., 120, 120, 121]], dtype=uint8), array([[199, 197, 197, ..., 204, 200, 198],
       [198, 197, 197, ..., 204, 204, 205],
       [197, 197, 197, ..., 206, 207, 209],
       ...,
       [ 98,  98,  99, ..., 124, 123, 121],
       [ 97,  98,  99, ..., 123, 122, 121],
       [ 96,  97,  98, ..., 122, 121, 120]], dtype=uint8), array([[205, 204, 203, ..., 207, 201, 197],
       [203, 203, 203, ..., 208, 206, 204],
       [201, 201, 202, ..., 207, 206, 206],
       ...,
       [ 19,  19,  19, ...,  22,  22,  21],
       [ 19,  19,  19, ...,  21,  21,  21],
       [ 19,  19,  20, ...,  21,  21,  21]], dtype=uint8), array([[209, 209, 209, ..., 234, 226, 224],
       [209, 210, 210, ..., 239, 234, 235],
       [209, 209, 209, ..., 240, 238, 239],
       ...,
       [105, 104, 105, ..., 134, 134, 133],
       [105, 104, 104, ..., 134, 133, 133],
       [105, 104, 104, ..., 135, 134, 133]], dtype=uint8), array([[171, 172, 173, ..., 207, 202, 200],
       [172, 172, 173, ..., 211, 209, 209],
       [171, 172, 172, ..., 211, 211, 212],
       ...,
       [102, 103, 102, ..., 120, 119, 121],
       [102, 103, 103, ..., 119, 118, 120],
       [103, 103, 103, ..., 120, 118, 119]], dtype=uint8), array([[208, 207, 206, ..., 237, 228, 225],
       [208, 207, 206, ..., 239, 233, 233],
       [208, 207, 206, ..., 238, 236, 238],
       ...,
       [106, 105, 105, ..., 134, 134, 134],
       [105, 104, 104, ..., 133, 134, 134],
       [104, 104, 103, ..., 132, 133, 133]], dtype=uint8), array([[150, 151, 152, ..., 185, 180, 177],
       [152, 153, 153, ..., 188, 187, 186],
       [153, 153, 153, ..., 189, 190, 191],
       ...,
       [ 91,  91,  92, ..., 107, 108, 107],
       [ 91,  91,  91, ..., 108, 108, 108],
       [ 91,  90,  90, ..., 108, 108, 107]], dtype=uint8), array([[208, 210, 209, ..., 236, 226, 225],
       [207, 208, 207, ..., 240, 235, 236],
       [207, 206, 206, ..., 241, 239, 240],
       ...,
       [104, 104, 105, ..., 132, 133, 135],
       [104, 104, 104, ..., 132, 133, 134],
       [104, 104, 104, ..., 132, 133, 134]], dtype=uint8), array([[205, 206, 206, ..., 230, 225, 221],
       [205, 205, 205, ..., 234, 232, 230],
       [205, 204, 204, ..., 235, 234, 234],
       ...,
       [114, 114, 113, ..., 130, 129, 129],
       [114, 114, 113, ..., 129, 129, 128],
       [113, 113, 112, ..., 129, 129, 129]], dtype=uint8), array([[186, 187, 188, ..., 209, 205, 202],
       [186, 186, 187, ..., 211, 210, 210],
       [187, 186, 187, ..., 212, 212, 213],
       ...,
       [100, 101, 101, ..., 119, 119, 118],
       [101, 100, 101, ..., 119, 119, 118],
       [101, 100, 100, ..., 119, 119, 118]], dtype=uint8), array([[206, 206, 206, ..., 235, 225, 224],
       [208, 208, 207, ..., 238, 233, 235],
       [208, 209, 208, ..., 239, 235, 237],
       ...,
       [106, 105, 104, ..., 132, 132, 131],
       [105, 104, 103, ..., 131, 131, 130],
       [104, 103, 102, ..., 131, 131, 130]], dtype=uint8), array([[212, 212, 212, ..., 231, 225, 224],
       [213, 213, 213, ..., 234, 232, 233],
       [211, 212, 213, ..., 234, 234, 236],
       ...,
       [115, 115, 114, ..., 133, 134, 134],
       [116, 115, 113, ..., 133, 133, 134],
       [115, 114, 113, ..., 133, 133, 134]], dtype=uint8), array([[ 25,  25,  25, ..., 192, 187, 186],
       [ 26,  26,  26, ..., 196, 192, 192],
       [ 26,  26,  26, ..., 196, 193, 194],
       ...,
       [ 14,  14,  14, ..., 115, 114, 114],
       [ 14,  14,  14, ..., 115, 114, 114],
       [ 14,  14,  14, ..., 115, 114, 114]], dtype=uint8), array([[211, 210, 209, ..., 200, 196, 192],
       [209, 210, 209, ..., 202, 200, 199],
       [208, 209, 210, ..., 202, 202, 204],
       ...,
       [ 24,  24,  24, ...,  22,  22,  23],
       [ 24,  24,  24, ...,  22,  22,  22],
       [ 24,  24,  24, ...,  22,  22,  22]], dtype=uint8), array([[153, 155, 157, ..., 181, 177, 175],
       [152, 153, 155, ..., 185, 183, 182],
       [153, 153, 153, ..., 186, 185, 184],
       ...,
       [ 94,  94,  95, ..., 109, 110, 111],
       [ 93,  93,  94, ..., 110, 111, 112],
       [ 93,  93,  93, ..., 110, 111, 112]], dtype=uint8), array([[200, 199, 199, ..., 187, 184, 182],
       [199, 198, 199, ..., 192, 191, 190],
       [197, 198, 198, ..., 192, 192, 193],
       ...,
       [111, 111, 112, ..., 123, 122, 122],
       [111, 112, 112, ..., 123, 122, 122],
       [112, 112, 111, ..., 123, 122, 122]], dtype=uint8), array([[189, 187, 187, ..., 196, 192, 190],
       [189, 188, 188, ..., 200, 198, 197],
       [188, 188, 190, ..., 200, 199, 199],
       ...,
       [ 93,  93,  93, ..., 117, 117, 118],
       [ 93,  93,  92, ..., 118, 117, 118],
       [ 95,  93,  92, ..., 118, 118, 117]], dtype=uint8), array([[205, 204, 204, ..., 192, 189, 188],
       [205, 205, 204, ..., 196, 195, 195],
       [204, 204, 204, ..., 197, 197, 197],
       ...,
       [115, 115, 115, ..., 126, 125, 125],
       [114, 114, 115, ..., 126, 126, 125],
       [115, 114, 114, ..., 126, 125, 125]], dtype=uint8), array([[ 31,  31,  31, ..., 187, 181, 179],
       [ 31,  31,  31, ..., 188, 186, 187],
       [ 31,  31,  31, ..., 190, 188, 189],
       ...,
       [ 25,  24,  24, ..., 121, 121, 121],
       [ 24,  24,  24, ..., 122, 121, 121],
       [ 24,  23,  23, ..., 122, 121, 121]], dtype=uint8), array([[ 34,  34,  34, ...,  15,  15,  15],
       [ 35,  35,  35, ...,  15,  15,  15],
       [ 35,  35,  35, ...,  15,  15,  15],
       ...,
       [ 96,  96,  96, ..., 120, 120, 120],
       [ 95,  96,  96, ..., 120, 119, 118],
       [ 96,  96,  96, ..., 120, 118, 117]], dtype=uint8), array([[188, 187, 186, ..., 207, 203, 201],
       [187, 187, 186, ..., 211, 210, 210],
       [187, 187, 187, ..., 212, 211, 211],
       ...,
       [104, 103, 103, ..., 117, 117, 118],
       [105, 104, 103, ..., 117, 117, 118],
       [105, 104, 103, ..., 117, 117, 118]], dtype=uint8), array([[202, 201, 202, ..., 231, 223, 224],
       [201, 201, 201, ..., 237, 232, 233],
       [201, 201, 202, ..., 238, 235, 237],
       ...,
       [102, 101, 100, ..., 131, 129, 129],
       [101, 100,  99, ..., 130, 129, 129],
       [101, 100, 100, ..., 129, 128, 129]], dtype=uint8), array([[197, 198, 199, ..., 188, 185, 183],
       [197, 198, 198, ..., 190, 190, 190],
       [198, 198, 198, ..., 192, 193, 194],
       ...,
       [113, 112, 111, ..., 122, 123, 124],
       [113, 112, 111, ..., 122, 122, 123],
       [112, 111, 111, ..., 121, 122, 122]], dtype=uint8), array([[190, 188, 187, ..., 195, 191, 186],
       [189, 188, 187, ..., 197, 195, 193],
       [188, 188, 188, ..., 197, 198, 198],
       ...,
       [ 93,  93,  92, ..., 117, 116, 117],
       [ 93,  92,  91, ..., 116, 116, 117],
       [ 93,  92,  91, ..., 116, 116, 117]], dtype=uint8), array([[155, 157, 157, ..., 183, 177, 176],
       [156, 157, 157, ..., 185, 183, 184],
       [156, 157, 157, ..., 184, 185, 185],
       ...,
       [ 94,  95,  95, ..., 113, 112, 112],
       [ 94,  94,  94, ..., 113, 112, 112],
       [ 94,  94,  93, ..., 113, 112, 112]], dtype=uint8), array([[173, 174, 174, ..., 206, 201, 197],
       [173, 173, 173, ..., 209, 208, 208],
       [174, 173, 173, ..., 208, 210, 211],
       ...,
       [104, 103, 103, ..., 121, 122, 124],
       [103, 103, 102, ..., 122, 123, 124],
       [103, 103, 102, ..., 122, 123, 124]], dtype=uint8), array([[196, 196, 196, ...,  23,  22,  22],
       [196, 197, 197, ...,  23,  23,  22],
       [196, 197, 198, ...,  23,  23,  23],
       ...,
       [ 97,  97,  97, ...,  22,  22,  22],
       [ 97,  96,  96, ...,  22,  23,  23],
       [ 97,  96,  96, ...,  22,  23,  23]], dtype=uint8), array([[ 19,  19,  19, ...,  32,  31,  30],
       [ 19,  19,  19, ...,  32,  32,  31],
       [ 18,  18,  18, ...,  32,  32,  32],
       ...,
       [112, 112, 111, ..., 123, 122, 122],
       [112, 112, 111, ..., 122, 122, 122],
       [111, 111, 110, ..., 121, 121, 122]], dtype=uint8), array([[204, 204, 205, ..., 229, 223, 220],
       [202, 203, 204, ..., 232, 231, 231],
       [201, 202, 203, ..., 233, 234, 235],
       ...,
       [102, 102, 102, ..., 131, 130, 130],
       [102, 102, 102, ..., 131, 130, 130],
       [103, 102, 102, ..., 131, 130, 130]], dtype=uint8), array([[196, 195, 195, ..., 192, 189, 186],
       [196, 196, 196, ..., 195, 194, 191],
       [195, 196, 196, ..., 195, 195, 194],
       ...,
       [ 94,  94,  93, ..., 116, 116, 118],
       [ 93,  93,  92, ..., 116, 115, 117],
       [ 92,  92,  92, ..., 115, 115, 117]], dtype=uint8), array([[198, 198, 198, ..., 191, 186, 184],
       [197, 198, 199, ..., 195, 193, 192],
       [197, 198, 199, ..., 196, 195, 196],
       ...,
       [111, 111, 111, ..., 122, 122, 123],
       [112, 112, 111, ..., 122, 123, 124],
       [112, 112, 111, ..., 122, 122, 123]], dtype=uint8), array([[207, 208, 208, ..., 234, 227, 226],
       [207, 207, 207, ..., 237, 232, 234],
       [206, 206, 205, ..., 236, 234, 236],
       ...,
       [114, 113, 112, ..., 131, 131, 131],
       [113, 113, 113, ..., 130, 131, 132],
       [113, 113, 113, ..., 131, 132, 133]], dtype=uint8), array([[201, 200, 200, ..., 190, 187, 186],
       [201, 201, 201, ..., 196, 194, 194],
       [200, 201, 201, ..., 199, 197, 196],
       ...,
       [113, 112, 112, ..., 123, 122, 122],
       [114, 113, 113, ..., 123, 123, 123],
       [115, 114, 113, ..., 123, 123, 123]], dtype=uint8)]
